from kafka import KafkaProducer
import random
file1 = open("interleaving commentary sequence.txt","w")
fid = ["194161014-4143","194161014-4144","194161014-4145","194161014-4146","194161014-4147","194161014-4148","194161014-4149","194161014-4150","194161014-4151","194161014-4152","194161014-4153","194161014-4154","194161014-4155","194161014-4157","194161014-4158","194161014-4159","194161014-4160","194161014-4161","194161014-4162","194161014-4163","194161014-4165","194161014-4166","194161014-4168","194161014-4169","194161014-4170","194161014-4171","194161014-4172","194161014-4173","194161014-4174","194161014-4175","194161014-4176","194161014-4177","194161014-4178","194161014-4179","194161014-4180","194161014-4182","194161014-4183","194161014-4184","194161014-4186","194161014-4187","194161014-4188","194161014-4190","194161014-4191","194161014-4192"]
fod = ["194161014-4143","194161014-4144","194161014-4145","194161014-4146","194161014-4147","194161014-4148","194161014-4149","194161014-4150","194161014-4151","194161014-4152","194161014-4153","194161014-4154","194161014-4155","194161014-4157","194161014-4158","194161014-4159","194161014-4160","194161014-4161","194161014-4162","194161014-4163","194161014-4165","194161014-4166","194161014-4168","194161014-4169","194161014-4170","194161014-4171","194161014-4172","194161014-4173","194161014-4174","194161014-4175","194161014-4176","194161014-4177","194161014-4178","194161014-4179","194161014-4180","194161014-4182","194161014-4183","194161014-4184","194161014-4186","194161014-4187","194161014-4188","194161014-4190","194161014-4191","194161014-4192"]
producers = []
rproducers = []
files = []
for i in range(0,44):
    producer = KafkaProducer(bootstrap_servers='localhost:9092')
    producers.append(producer)
    file = open(fid[i]+"_com.txt")
    files.append(file)
fopen = files

count = 44
pre = -1

while count > 0:


    r = random.randint(0, 43)

    if count != 1:

        while r == pre or fid[r]  not in fod:
            r = (r+1)%44
    else:
        while fid[r]  not in fod:
            r = (r+1)%44


    pre = r

    m = fopen[r].readline()
    if "##########" not in m:
        file1.write(fid[r]+"     "+m)
        producers[r].send(fid[r], str.encode(m))
        print(fid[r] + "     " + m)

    else:

        producers[r].send(fid[r], str.encode(m))
        file1.write(fid[r] + "     " + m)
        print(fid[r] + "     " + m)
        fopen[r].close()
        fod.remove(fid[r])
        count = count-1





file1.close()

